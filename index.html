<!DOCTYPE html>
<html>
<head>
 <title>Leaflet + D3.js</title>
 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
 <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
 <script src="https://d3js.org/d3.v5.min.js"></script>
 <style>
   #map {
     height: 100vh;
   }
 </style>
</head>
<body>
 <div id="map"></div>
 <script>
   // Initialize the map
   let map = L.map('map').setView([40.7128, -74.0060], 13);

   L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
     attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
   }).addTo(map);

   // Define the cities and their coordinates
   let cities = {
     "New York": {
       "coordinates": [40.7128, -74.0060],
       "data": null
     },
     "Los Angeles": {
       "coordinates": [34.0522, -118.2437],
       "data": null
     }
     // add more cities as needed
   };

   // Add markers for each city
   for (let cityName in cities) {
     let marker = L.marker(cities[cityName].coordinates).addTo(map);
     marker.cityName = cityName;

     // Fetch the city data when the marker is clicked
     marker.on('click', function(e) {
       let cityName = e.target.cityName;
       fetchCityData(cityName);
     });
   }

   // Fetch the city data from the backend
   function fetchCityData(cityName) {
     d3.json(`http://localhost:3000/cities/${cityName}`)
       .then(function(data) {
         cities[cityName].data = data;
         createChart(cityName);
       })
       .catch(function(error) {
         console.log(error);
       });
   }

   // Create a chart with D3.js using the city data
   function createChart(cityName) {
     let data = cities[cityName].data;
     // create a chart with D3.js using the data
     // this is just a placeholder. replace with your actual D3.js code
     console.log(data);
   }
 </script>
</body>
</html>

